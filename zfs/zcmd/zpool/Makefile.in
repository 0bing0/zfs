DISTFILES = Makefile.in zpool_main.c zpool_iter.c zpool_util.c zpool_vdev.c zpool_util.h

CMD := zpool

HOSTCFLAGS += @HOSTCFLAGS@
HOSTCFLAGS += -I@CMDDIR@/zpool/
HOSTCFLAGS += -I@LIBDIR@/libspl/include
HOSTCFLAGS += -I@LIBDIR@/libavl/include
HOSTCFLAGS += -I@LIBDIR@/libnvpair/include
HOSTCFLAGS += -I@LIBDIR@/libumem/include
HOSTCFLAGS += -I@LIBDIR@/libuutil/include
HOSTCFLAGS += -I@LIBDIR@/libzcommon/include
HOSTCFLAGS += -I@LIBDIR@/libzfs/include

HOSTLDFLAGS += -lavl -L@LIBDIR@/libavl
HOSTLDFLAGS += -lnvpair -L@LIBDIR@/libnvpair
HOSTLDFLAGS += -lumem -L@LIBDIR@/libumem
HOSTLDFLAGS += -luutil -L@LIBDIR@/libuutil
HOSTLDFLAGS += -lzport -L@LIBDIR@/libspl
HOSTLDFLAGS += -lzcommon -L@LIBDIR@/libzcommon
HOSTLDFLAGS += -lzfs -L@LIBDIR@/libzfs

# Additional shared library paths for executing binaries in-tree
export LD_RUN_PATH = @LIBDIR@/libavl:@LIBDIR@/libnvpair:@LIBDIR@/libumem:@LIBDIR@/libuutil:@LIBDIR@/libspl:@LIBDIR@/libzcommon:@LIBDIR@/libzfs

hostprogs-y := ${CMD}
always := $(hostprogs-y)

${CMD}-objs += zpool_main.o	# Arg processing
${CMD}-objs += zpool_iter.o	# Iterator support
${CMD}-objs += zpool_util.o	# Misc support
${CMD}-objs += zpool_vdev.o	# Converts vdevs to nvlists for libzfs
