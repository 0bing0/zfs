subdir-m += include
DISTFILES = libnvpair.c nvpair.c nvpair_alloc_fixed.c nvpair_alloc_system.c

MODULE  := znvpair
LIBRARY := libnvpair

# Compile as kernel module.  Needed symlinks created for all
# k* objects created by top level configure script.

EXTRA_CFLAGS  = @KERNELCPPFLAGS@
EXTRA_CFLAGS += -I@LIBDIR@/libnvpair/include

obj-m := ${MODULE}.o

${MODULE}-objs += knvpair.o		# Interfaces name/value pairs
${MODULE}-objs += nvpair_alloc_spl.o	# Generic alloc/free support

# Compile as shared library.  There's an extra useless host program
# here called 'zu' because it was the easiest way I could convince
# the kernel build system to construct a user space shared library.

HOSTCFLAGS += @HOSTCFLAGS@
HOSTCFLAGS += -I@LIBDIR@/libspl/include
HOSTCFLAGS += -I@LIBDIR@/libnvpair/include

hostprogs-y := zu
always := $(hostprogs-y)

zu-objs := zu.o ${LIBRARY}.so

${LIBRARY}-objs += unvpair.o
${LIBRARY}-objs += nvpair_alloc_system.o
${LIBRARY}-objs += libnvpair.o
