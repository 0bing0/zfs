subdir-m += include
DISTFILES = Makefile.in *.c

LIBRARY := libuutil

# Compile as shared library.  There's an extra useless host program
# here called 'zu' because it was the easiest way I could convince
# the kernel build system to construct a user space shared library.

HOSTCFLAGS += @HOSTCFLAGS@
HOSTCFLAGS += -I@LIBDIR@/libspl/include
HOSTCFLAGS += -I@LIBDIR@/libavl/include
HOSTCFLAGS += -I@LIBDIR@/libuutil/include
HOSTCFLAGS += -DNATIVE_BUILD

HOSTLDFLAGS += -pthread
HOSTLDFLAGS += -lrt
HOSTLDFLAGS += -lavl -L@LIBDIR@/libavl
HOSTLDFLAGS += -lzport -L@LIBDIR@/libspl

hostprogs-y := zu
always := $(hostprogs-y)

zu-objs := zu.o ${LIBRARY}.so

${LIBRARY}-objs += uu_alloc.o
${LIBRARY}-objs += uu_avl.o
${LIBRARY}-objs += uu_dprintf.o
${LIBRARY}-objs += uu_ident.o
${LIBRARY}-objs += uu_list.o
${LIBRARY}-objs += uu_misc.o
${LIBRARY}-objs += uu_open.o
${LIBRARY}-objs += uu_pname.o
${LIBRARY}-objs += uu_strtoint.o
